{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hp\\\\Desktop\\\\super150\\\\startup\\\\project\\\\pandit-booking-frontend\\\\src\\\\pages\\\\ChatWindow.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\n\n// Use your deployed backend URL here to connect Socket.IO\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BACKEND_URL = 'http://localhost:5000';\n\n// Create Socket.IO client instance\nconst socket = io(BACKEND_URL, {\n  autoConnect: false,\n  transports: ['websocket', 'polling']\n});\nfunction ChatWindow({\n  userId,\n  panditId,\n  onClose,\n  chatName\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const roomId = `${userId}_${panditId}`; // Ensures same room on both sides\n  const messagesEndRef = useRef(null);\n\n  // Track sent messages to avoid duplicates\n  const sentMessageIds = useRef(new Set());\n  useEffect(() => {\n    socket.connect();\n    socket.emit('joinRoom', roomId);\n    socket.on('receiveMessage', msg => {\n      const msgId = `${msg.timestamp}_${msg.senderId}`;\n      if (sentMessageIds.current.has(msgId)) {\n        return; // Ignore duplicate message\n      }\n      setMessages(prev => [...prev, msg]);\n    });\n    return () => {\n      socket.off('receiveMessage');\n      socket.disconnect();\n      sentMessageIds.current.clear();\n    };\n  }, [roomId]);\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  const sendMessage = () => {\n    if (!input.trim()) return;\n    const msgObj = {\n      roomId,\n      senderId: userId,\n      message: input,\n      timestamp: Date.now()\n    };\n    sentMessageIds.current.add(`${msgObj.timestamp}_${msgObj.senderId}`);\n    setMessages(prev => [...prev, msgObj]);\n    socket.emit('sendMessage', msgObj);\n    setInput('');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      bottom: 0,\n      right: 0,\n      width: 350,\n      height: 400,\n      border: '1px solid #ccc',\n      backgroundColor: 'white',\n      display: 'flex',\n      flexDirection: 'column',\n      boxShadow: '0 0 10px rgba(0,0,0,0.3)',\n      zIndex: 9999\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 10,\n        borderBottom: '1px solid #ddd',\n        backgroundColor: '#f5f5f5'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: [\"Chat with \", chatName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        style: {\n          float: 'right',\n          border: 'none',\n          background: 'transparent',\n          cursor: 'pointer'\n        },\n        \"aria-label\": \"Close chat\",\n        children: \"\\u2716\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        overflowY: 'auto',\n        padding: 10,\n        fontSize: 14\n      },\n      children: [messages.map((msg, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 8,\n          textAlign: msg.senderId === userId ? 'right' : 'left'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            display: 'inline-block',\n            backgroundColor: msg.senderId === userId ? '#DCF8C6' : '#EEE',\n            padding: '6px 12px',\n            borderRadius: 20,\n            maxWidth: '80%',\n            wordWrap: 'break-word'\n          },\n          children: msg.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 10,\n        borderTop: '1px solid #ddd',\n        display: 'flex'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Type a message\",\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: e => {\n          if (e.key === 'Enter') sendMessage();\n        },\n        style: {\n          flex: 1,\n          marginRight: 5,\n          padding: 8\n        },\n        \"aria-label\": \"Message input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendMessage,\n        \"aria-label\": \"Send message\",\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatWindow, \"KilAH1qr9IBj04BTxW+khYbCq20=\");\n_c = ChatWindow;\nexport default ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useState","useEffect","useRef","io","jsxDEV","_jsxDEV","BACKEND_URL","socket","autoConnect","transports","ChatWindow","userId","panditId","onClose","chatName","_s","messages","setMessages","input","setInput","roomId","messagesEndRef","sentMessageIds","Set","connect","emit","on","msg","msgId","timestamp","senderId","current","has","prev","off","disconnect","clear","_messagesEndRef$curre","scrollIntoView","behavior","sendMessage","trim","msgObj","message","Date","now","add","style","position","bottom","right","width","height","border","backgroundColor","display","flexDirection","boxShadow","zIndex","children","padding","borderBottom","fileName","_jsxFileName","lineNumber","columnNumber","onClick","float","background","cursor","flex","overflowY","fontSize","map","i","marginBottom","textAlign","borderRadius","maxWidth","wordWrap","ref","borderTop","type","placeholder","value","onChange","e","target","onKeyDown","key","marginRight","_c","$RefreshReg$"],"sources":["C:/Users/hp/Desktop/super150/startup/project/pandit-booking-frontend/src/pages/ChatWindow.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\n\r\n// Use your deployed backend URL here to connect Socket.IO\r\nconst BACKEND_URL = 'http://localhost:5000';\r\n\r\n// Create Socket.IO client instance\r\nconst socket = io(BACKEND_URL, {\r\n  autoConnect: false,\r\n  transports: ['websocket', 'polling'],\r\n});\r\n\r\nfunction ChatWindow({ userId, panditId, onClose, chatName }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const roomId = `${userId}_${panditId}`; // Ensures same room on both sides\r\n  const messagesEndRef = useRef(null);\r\n\r\n  // Track sent messages to avoid duplicates\r\n  const sentMessageIds = useRef(new Set());\r\n\r\n  useEffect(() => {\r\n    socket.connect();\r\n    socket.emit('joinRoom', roomId);\r\n\r\n    socket.on('receiveMessage', (msg) => {\r\n      const msgId = `${msg.timestamp}_${msg.senderId}`;\r\n      if (sentMessageIds.current.has(msgId)) {\r\n        return; // Ignore duplicate message\r\n      }\r\n      setMessages(prev => [...prev, msg]);\r\n    });\r\n\r\n    return () => {\r\n      socket.off('receiveMessage');\r\n      socket.disconnect();\r\n      sentMessageIds.current.clear();\r\n    };\r\n  }, [roomId]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  const sendMessage = () => {\r\n    if (!input.trim()) return;\r\n\r\n    const msgObj = {\r\n      roomId,\r\n      senderId: userId,\r\n      message: input,\r\n      timestamp: Date.now(),\r\n    };\r\n\r\n    sentMessageIds.current.add(`${msgObj.timestamp}_${msgObj.senderId}`);\r\n\r\n    setMessages(prev => [...prev, msgObj]);\r\n    socket.emit('sendMessage', msgObj);\r\n    setInput('');\r\n  };\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'fixed', bottom: 0, right: 0, width: 350, height: 400,\r\n      border: '1px solid #ccc', backgroundColor: 'white', display: 'flex',\r\n      flexDirection: 'column', boxShadow: '0 0 10px rgba(0,0,0,0.3)', zIndex: 9999\r\n    }}>\r\n      <div style={{ padding: 10, borderBottom: '1px solid #ddd', backgroundColor: '#f5f5f5' }}>\r\n        <strong>Chat with {chatName}</strong>\r\n        <button\r\n          onClick={onClose}\r\n          style={{ float: 'right', border: 'none', background: 'transparent', cursor: 'pointer' }}\r\n          aria-label=\"Close chat\"\r\n        >\r\n          âœ–\r\n        </button>\r\n      </div>\r\n      <div style={{ flex: 1, overflowY: 'auto', padding: 10, fontSize: 14 }}>\r\n        {messages.map((msg, i) => (\r\n          <div key={i} style={{ marginBottom: 8, textAlign: msg.senderId === userId ? 'right' : 'left' }}>\r\n            <span style={{\r\n              display: 'inline-block',\r\n              backgroundColor: msg.senderId === userId ? '#DCF8C6' : '#EEE',\r\n              padding: '6px 12px',\r\n              borderRadius: 20,\r\n              maxWidth: '80%',\r\n              wordWrap: 'break-word',\r\n            }}>\r\n              {msg.message}\r\n            </span>\r\n          </div>\r\n        ))}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n      <div style={{ padding: 10, borderTop: '1px solid #ddd', display: 'flex' }}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Type a message\"\r\n          value={input}\r\n          onChange={e => setInput(e.target.value)}\r\n          onKeyDown={e => { if (e.key === 'Enter') sendMessage() }}\r\n          style={{ flex: 1, marginRight: 5, padding: 8 }}\r\n          aria-label=\"Message input\"\r\n        />\r\n        <button onClick={sendMessage} aria-label=\"Send message\">Send</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatWindow;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}