{"ast":null,"code":"// import React, { useState, useEffect, useRef } from \"react\";\n// import {\n//   Home,\n//   CalendarDays,\n//   Book,\n//   LogOut,\n//   ListChecks,\n//   MessageCircle,\n//   Search,\n//   Users,\n//   ChevronLeft,\n//   ChevronRight,\n// } from \"lucide-react\";\n// import { AnimatePresence, motion } from \"framer-motion\";\n// import AOS from \"aos\";\n// import \"aos/dist/aos.css\";\n// import \"./Dashboard.css\";\n// import {\n//   createReview,\n//   getBookings,\n//   getVerifiedPandits,\n//   bookPuja,\n// } from \"../api/api\"; // <-- add your actual booking API here\n// import ChatWindow from \"./ChatWindow\";\n// import { useNavigate } from \"react-router-dom\";\n\n// const sidebarLinks = [\n//   { label: \"Home\", icon: Home, goto: \"/\" },\n//   { label: \"Book Puja\", icon: Book, goto: \"/booking\" },\n//   { label: \"Submit Review\", icon: MessageCircle, goto: \"#review\" },\n//   { label: \"Pandits\", icon: Users, goto: \"#pandit\" },\n//   { label: \"Search\", icon: Search, goto: \"#highlight\" },\n//   { label: \"Bookings\", icon: CalendarDays, goto: \"#booking\" },\n//   { label: \"Logout\", icon: LogOut, goto: \"/home\", logout: true },\n// ];\n\n// const sliderImages = [\n//   \"/images/i2.jpeg\",\n//   \"/images/kalash.jpeg\",\n//   \"/images/havan.jpeg\",\n//   \"/images/i3.jpeg\",\n//   \"/images/i1.jpeg\",\n// ];\n\n// function StarRating({ rating, onChange }) {\n//   return (\n//     <div className=\"star-rating\" aria-label=\"Rating\">\n//       {[1, 2, 3, 4, 5].map((i) => (\n//         <span\n//           key={i}\n//           role=\"button\"\n//           tabIndex=\"0\"\n//           className={`star ${i <= rating ? \"active\" : \"\"}`}\n//           aria-label={`Rate ${i} star${i > 1 ? \"s\" : \"\"}`}\n//           onClick={() => onChange(i)}\n//           onKeyDown={(e) =>\n//             (e.key === \"Enter\" || e.key === \" \") && onChange(i)\n//           }\n//         >\n//           ★\n//         </span>\n//       ))}\n//     </div>\n//   );\n// }\n\n// export default function Dashboard() {\n//   const [user, setUser] = useState(null);\n//   const [bookings, setBookings] = useState([]);\n//   const [pandits, setPandits] = useState([]);\n//   const [collapsed, setCollapsed] = useState(false);\n//   const [carouselIndex, setCarouselIndex] = useState(0);\n//   const [expandedPandits, setExpandedPandits] = useState({});\n//   const [searchPandits, setSearchPandits] = useState(\"\");\n//   const [searchBookings, setSearchBookings] = useState(\"\");\n//   const [review, setReview] = useState({ name: \"\", rating: 0, comment: \"\" });\n//   const [reviewMessage, setReviewMessage] = useState(\"\");\n//   const [reviewLoading, setReviewLoading] = useState(false);\n//   const [showChatbot, setShowChatbot] = useState(false);\n//   const [chatPanditId, setChatPanditId] = useState(null);\n//   const [chatPanditName, setChatPanditName] = useState(\"\");\n//   const [currentDateTime, setCurrentDateTime] = useState(\"\");\n\n//   // Booking state integrated in dashboard\n//   const [selectedPanditId, setSelectedPanditId] = useState(\"\");\n//   const [selectedServiceId, setSelectedServiceId] = useState(\"\");\n//   const [bookingDetails, setBookingDetails] = useState({\n//     puja_date: \"\",\n//     puja_time: \"\",\n//     location: \"\",\n//   });\n//   const [bookingStatus, setBookingStatus] = useState(null);\n//   const [bookingLoading, setBookingLoading] = useState(false);\n\n//   const navigate = useNavigate();\n\n//   const panditListRef = useRef(null);\n//   const bookingListRef = useRef(null);\n\n//   // Fetch user, bookings, pandits on mount\n//   useEffect(() => {\n//     AOS.init({ duration: 750, once: true });\n//     const token = localStorage.getItem(\"token\");\n//     const userData = localStorage.getItem(\"user\");\n//     if (!token || !userData) return;\n//     try {\n//       const parsedUser = JSON.parse(userData);\n//       setUser(parsedUser);\n//       setReview((r) => ({ ...r, name: parsedUser.name }));\n//       getBookings({ userid: parsedUser._id }).then((res) =>\n//         setBookings(res.data || [])\n//       );\n//       getVerifiedPandits().then((res) => setPandits(res.data || []));\n//     } catch {}\n//   }, []);\n\n//   useEffect(() => {\n//     const interval = setInterval(() => {\n//       setCarouselIndex((i) => (i + 1) % sliderImages.length);\n//     }, 4500);\n//     return () => clearInterval(interval);\n//   }, []);\n\n//   useEffect(() => {\n//     const itv = setInterval(() => {\n//       setCurrentDateTime(\n//         new Date().toLocaleString(\"en-IN\", {\n//           dateStyle: \"full\",\n//           timeStyle: \"medium\",\n//           timeZone: \"Asia/Kolkata\",\n//         })\n//       );\n//     }, 1000);\n//     return () => clearInterval(itv);\n//   }, []);\n\n//   function toggleExpand(id) {\n//     setExpandedPandits((prev) => ({ ...prev, [id]: !prev[id] }));\n//   }\n\n//   const getStatusClass = (status) =>\n//     ({\n//       accepted: \"status accepted\",\n//       rejected: \"status rejected\",\n//       pending: \"status pending\",\n//     }[(status || \"\").toLowerCase()] || \"status\");\n\n//   const filteredPandits = pandits.filter(\n//     (p) =>\n//       (p.name?.toLowerCase() || \"\").includes(searchPandits.toLowerCase()) ||\n//       (p.city || \"\").toLowerCase().includes(searchPandits.toLowerCase())\n//   );\n\n//   const filteredBookings = bookings.filter((b) => {\n//     const q = searchBookings.toLowerCase();\n//     return (\n//       (b.panditid?.name || \"\").toLowerCase().includes(q) ||\n//       (b.serviceid?.name || \"\").toLowerCase().includes(q) ||\n//       new Date(b.puja_date).toLocaleDateString().includes(q)\n//     );\n//   });\n\n//   async function handleReviewSubmit(e) {\n//     e.preventDefault();\n//     if (!review.name || !review.comment || !review.rating) {\n//       setReviewMessage(\"Please complete all fields and provide star rating.\");\n//       return;\n//     }\n//     setReviewLoading(true);\n//     try {\n//       await createReview(review);\n//       setReviewMessage(\"Thank you for your review!\");\n//       setReview((r) => ({ name: r.name, rating: 0, comment: \"\" }));\n//     } catch {\n//       setReviewMessage(\"Failed to submit review.\");\n//     } finally {\n//       setReviewLoading(false);\n//       setTimeout(() => setReviewMessage(\"\"), 2500);\n//     }\n//   }\n\n//   function handleNavClick(item) {\n//     if (item.logout) {\n//       localStorage.clear();\n//       alert(\"Logout clicked, implement navigation\");\n//     } else if (String(item.goto).startsWith(\"#\")) {\n//       const section = document.querySelector(item.goto);\n//       if (section)\n//         section.scrollIntoView({\n//           behavior: \"smooth\",\n//           block: \"start\",\n//           inline: \"nearest\",\n//         });\n//     } else {\n//       navigate(item.goto);\n//     }\n//   }\n\n//   function scrollList(ref, direction = \"left\") {\n//     if (ref.current) {\n//       const scrollAmount = 320;\n//       if (direction === \"left\") {\n//         ref.current.scrollBy({ left: -scrollAmount, behavior: \"smooth\" });\n//       } else {\n//         ref.current.scrollBy({ left: scrollAmount, behavior: \"smooth\" });\n//       }\n//     }\n//   }\n\n//   // Booking form handlers\n//   function handlePanditSelect(e) {\n//     const panditId = e.target.value;\n//     setSelectedPanditId(panditId);\n//     setSelectedServiceId(\"\"); // reset selected service on pandit change\n//     setBookingStatus(null);\n//   }\n\n//   function handleServiceSelect(e) {\n//     setSelectedServiceId(e.target.value);\n//     setBookingStatus(null);\n//   }\n\n//   function handleBookingDetailsChange(e) {\n//     const { name, value } = e.target;\n//     setBookingDetails((b) => ({ ...b, [name]: value }));\n//     setBookingStatus(null);\n//   }\n\n//   async function handleBookingSubmit(e) {\n//     e.preventDefault();\n//     setBookingStatus(null);\n\n//     if (!selectedPanditId) {\n//       setBookingStatus({ error: \"Please select a Pandit.\" });\n//       return;\n//     }\n//     if (!selectedServiceId) {\n//       setBookingStatus({ error: \"Please select the Puja/service.\" });\n//       return;\n//     }\n//     if (\n//       !bookingDetails.puja_date ||\n//       !bookingDetails.puja_time ||\n//       !bookingDetails.location.trim()\n//     ) {\n//       setBookingStatus({ error: \"Please fill all booking details.\" });\n//       return;\n//     }\n//     if(!user?._id) {\n//       setBookingStatus({ error: \"User not found. Please login again.\" });\n//       return;\n//     }\n\n//     setBookingLoading(true);\n\n//     try {\n//       // Prepare payload\n//       const payload = {\n//         userId: user._id,\n//         panditId: selectedPanditId,\n//         serviceId: selectedServiceId,\n//         puja_date: bookingDetails.puja_date,\n//         puja_time: bookingDetails.puja_time,\n//         location: bookingDetails.location.trim(),\n//         status: \"pending\",\n//       };\n\n//       // Replace this with your actual booking API call\n//       if (typeof bookPuja === \"function\") {\n//         await bookPuja(payload);\n//       } else {\n//         // Mock API delay\n//         await new Promise((res) => setTimeout(res, 1000));\n//       }\n\n//       setBookingStatus({ success: \"Puja booked successfully!\" });\n\n//       // Refresh bookings list after booking\n//       const res = await getBookings({ userid: user._id });\n//       setBookings(res.data || []);\n\n//       // Reset booking form\n//       setSelectedPanditId(\"\");\n//       setSelectedServiceId(\"\");\n//       setBookingDetails({ puja_date: \"\", puja_time: \"\", location: \"\" });\n//     } catch (error) {\n//       setBookingStatus({\n//         error:\n//           error?.message ||\n//           \"Failed to book puja. Please try again later.\",\n//       });\n//     } finally {\n//       setBookingLoading(false);\n//     }\n//   }\n\n//   // Get selected pandit's services (pujas)\n//   const selectedPandit =\n//     pandits.find((p) => p._id === selectedPanditId) || null;\n\n//   const servicesOptions = selectedPandit?.services || []; // Assuming your pandit object has a services array\n\n//   return (\n//     <div className=\"dashboard-app-bg\">\n//       {/* Sidebar */}\n//       <aside className={`sidebar-root${collapsed ? \" collapsed\" : \"\"}`}>\n//         <div className=\"sidebar-brand\">\n//           <img src=\"/images/subh.png\" alt=\"Logo\" className=\"sidebar-logo\" />\n//           {!collapsed && (\n//             <span\n//               className=\"sidebar-brand-name white-logo\"\n//               tabIndex={0}\n//               style={{ color: \"#1abc9c\" }}\n//             >\n//               Shubhkarya\n//             </span>\n//           )}\n//         </div>\n//         <nav className=\"sidebar-links\" aria-label=\"Main navigation\">\n//           {sidebarLinks.map(({ label, icon: Icon, goto, logout }) => (\n//             <button\n//               key={label}\n//               className=\"sidebar-link\"\n//               tabIndex={0}\n//               onClick={() => handleNavClick({ goto, logout })}\n//               aria-label={label}\n//             >\n//               <Icon\n//                 size={22}\n//                 className=\"sidebar-link-icon\"\n//                 aria-hidden=\"true\"\n//                 style={{ color: \"#1abc9c\" }}\n//               />\n//               {!collapsed && (\n//                 <span style={{ color: \"#1abc9c\", fontWeight: \"700\" }}>\n//                   {label}\n//                 </span>\n//               )}\n//             </button>\n//           ))}\n//         </nav>\n//         <button\n//           className=\"sidebar-collapse-btn\"\n//           onClick={() => setCollapsed((c) => !c)}\n//           aria-label={collapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\n//           style={{ color: \"#1abc9c\" }}\n//         >\n//           <ListChecks size={22} />\n//         </button>\n//       </aside>\n\n//       {/* Header */}\n//       <header className=\"header-root dark-header\">\n//         <div className=\"user-block\">\n//           <div>\n//             <div className=\"header-user-welcome dark-welcome\">\n//               {user?.name ? `Welcome, ${user.name}!` : \"Welcome to Shubhkarya\"}\n//             </div>\n//             <div className=\"header-user-email dark-email\">\n//               {user?.email || \"user@example.com\"}\n//             </div>\n//           </div>\n//         </div>\n//         <div className=\"header-datetime dark-datetime\">{currentDateTime}</div>\n//       </header>\n\n//       <main className=\"dashboard-main\">\n//         {/* Hero & Slider */}\n//         <section className=\"hero-section\">\n//           <div className=\"hero-content\">\n//             <h1 className=\"hero-title\">\n//               Experience{\" \"}\n//               <span className=\"hero-highlight\">Auspicious Rituals</span> with{\" \"}\n//               <span className=\"hero-brand-white\">Shubhkarya</span>\n//             </h1>\n//             <p className=\"hero-subtitle\">\n//               Welcome{user?.name && <span>, <b>{user.name}</b></span>}!\n//               <br />\n//               Book trusted Pandits for your{\" \"}\n//               <span style={{ color: \"#fcd75a\", fontWeight: 600 }}>\n//                 pujas, havans, and ceremonies\n//               </span>{\" \"}\n//               with elegance and ease.\n//               <br />\n//               Now enhanced with same-day bookings and instant chat support.\n//             </p>\n//             <div className=\"hero-actions\">\n//               <button\n//                 className=\"main-cta-btn\"\n//                 onClick={() => navigate(\"/booking\")}\n//               >\n//                 Book Puja Now\n//               </button>\n//               <button\n//                 className=\"main-alt-btn\"\n//                 onClick={() => {\n//                   const panditSection = document.querySelector(\"#pandit\");\n//                   if (panditSection) {\n//                     panditSection.scrollIntoView({ behavior: \"smooth\" });\n//                   }\n//                 }}\n//               >\n//                 Browse Pandits\n//               </button>\n//             </div>\n//           </div>\n//           <div className=\"slider-wrapper\">\n//             <div className=\"carousel-frame hero-slider-bg\">\n//               <img\n//                 src={sliderImages[carouselIndex]}\n//                 alt={`Slide ${carouselIndex + 1}`}\n//                 loading=\"lazy\"\n//               />\n//               <div className=\"carousel-dots\">\n//                 {sliderImages.map((_, i) => (\n//                   <button\n//                     key={i}\n//                     className={`carousel-dot${carouselIndex === i ? \" active\" : \"\"}`}\n//                     onClick={() => setCarouselIndex(i)}\n//                     aria-selected={carouselIndex === i}\n//                     role=\"tab\"\n//                     aria-label={`Go to slide ${i + 1}`}\n//                   />\n//                 ))}\n//               </div>\n//               <div className=\"slider-caption\">\n//                 <div>\n//                   Find <span style={{ color: \"#fcd75a\" }}>expert guidance</span>{\" \"}\n//                   for every ritual\n//                 </div>\n//               </div>\n//             </div>\n//           </div>\n//         </section>\n\n//         {/* Feature Cards */}\n//         <section className=\"dashboard-features\">\n//           <div className=\"feature-card\">\n//             <h3>Live Chat Support</h3>\n//             <p>Ask spiritual or booking questions to our team – instant help, 7am to 10pm.</p>\n//           </div>\n//           <div className=\"feature-card\">\n//             <h3>Preferred Pandit Booking</h3>\n//             <p>Save favorite Pandits, see their next available slots, and book with just one tap.</p>\n//           </div>\n//           <div className=\"feature-card\">\n//             <h3>Festive Offers</h3>\n//             <p>Special discounts and promo codes for all major festivals and family events.</p>\n//           </div>\n//         </section>\n\n//         {/* Verified Pandits */}\n//         <section\n//           id=\"pandit\"\n//           className=\"pandit-section horizontal-carousel-section\"\n//           tabIndex={-1}\n//           aria-label=\"Verified Pandits\"\n//         >\n//           <div className=\"section-header\">\n//             <h3 className=\"section-heading highlighted-heading\">Verified Pandits</h3>\n//             <div className=\"carousel-controls\">\n//               <button\n//                 aria-label=\"Scroll pandits left\"\n//                 onClick={() => scrollList(panditListRef, \"left\")}\n//                 className=\"carousel-arrow-btn\"\n//               >\n//                 <ChevronLeft size={24} />\n//               </button>\n//               <button\n//                 aria-label=\"Scroll pandits right\"\n//                 onClick={() => scrollList(panditListRef, \"right\")}\n//                 className=\"carousel-arrow-btn\"\n//               >\n//                 <ChevronRight size={24} />\n//               </button>\n//             </div>\n//           </div>\n//           <input\n//             type=\"text\"\n//             className=\"booking-search\"\n//             aria-label=\"Search pandits\"\n//             placeholder=\"Search by name or city...\"\n//             value={searchPandits}\n//             onChange={(e) => setSearchPandits(e.target.value)}\n//           />\n//           <div\n//             className=\"pandit-list horizontal-scroll\"\n//             ref={panditListRef}\n//             tabIndex={0}\n//           >\n//             {filteredPandits.map((pandit) => (\n//               <motion.div\n//                 key={pandit._id}\n//                 className=\"improved-pandit-card neon-card glass-highlight glossy shadow-pop horizontal-card\"\n//                 whileHover={{ y: -4, scale: 1.04 }}\n//                 tabIndex={0}\n//                 aria-expanded={expandedPandits[pandit._id] || false}\n//                 onClick={() => toggleExpand(pandit._id)}\n//                 onKeyDown={(e) =>\n//                   (e.key === \"Enter\" || e.key === \" \") && toggleExpand(pandit._id)\n//                 }\n//               >\n//                 <div\n//                   className=\"pandit-avatar glass\"\n//                   style={{\n//                     backgroundImage: `url(${pandit.profile_photo_url || \"/images/i1.jpeg\"})`,\n//                   }}\n//                   aria-label={`Pandit ${pandit.name}`}\n//                 >\n//                   <span className=\"pandit-avatar-initial\">{pandit.name.slice(0, 1)}</span>\n//                 </div>\n//                 <div className=\"pandit-main-info\">\n//                   <h4 className=\"pandit-name hero-text-glow\">🧑‍🦳 {pandit.name}</h4>\n//                   <div className=\"pandit-city\">{pandit.city}</div>\n//                   {expandedPandits[pandit._id] && (\n//                     <div className=\"pandit-extra expanded horizontal-extra\">\n//                       <div className=\"pandit-details\">\n//                         <div className=\"pandit-badges\">\n//                           <span className=\"pandit-badge exp\">\n//                             Exp: {pandit.experienceYears} yrs\n//                           </span>\n//                           <span className=\"pandit-badge langs\">\n//                             {pandit.languages?.join(\", \")}\n//                           </span>\n//                         </div>\n//                         <div className=\"pandit-specialties\">\n//                           <b>Specialties:</b> {pandit.specialties?.join(\", \")}\n//                         </div>\n//                       </div>\n//                     </div>\n//                   )}\n//                   <button\n//                     onClick={(e) => {\n//                       e.stopPropagation();\n//                       setChatPanditId(pandit._id);\n//                       setChatPanditName(pandit.name);\n//                     }}\n//                     style={{ marginTop: 8 }}\n//                     aria-label={`Chat with ${pandit.name}`}\n//                   >\n//                     Chat with Pandit\n//                   </button>\n//                 </div>\n//               </motion.div>\n//             ))}\n//           </div>\n//         </section>\n\n//         {/* NEW Booking Section - Integrated on same page */}\n//         <section\n//           id=\"book-puja\"\n//           className=\"book-puja-section glass-review\"\n//           aria-label=\"Book Puja\"\n//           tabIndex={-1}\n//           style={{ marginTop: \"3rem\", marginBottom: \"3rem\", maxWidth: 700, marginLeft:\"auto\", marginRight:\"auto\" }}\n//         >\n//           <h3 className=\"section-heading highlighted-heading\" style={{ textAlign: \"center\" }}>\n//             Book Your Puja\n//           </h3>\n\n//           <form onSubmit={handleBookingSubmit} className=\"booking-form-dashboard\" aria-live=\"polite\" noValidate>\n//             <label htmlFor=\"selectPandit\">Select Pandit:</label>\n//             <select\n//               id=\"selectPandit\"\n//               value={selectedPanditId}\n//               onChange={handlePanditSelect}\n//               aria-required=\"true\"\n//               required\n//             >\n//               <option value=\"\">-- Select Pandit --</option>\n//               {filteredPandits.map((p) => (\n//                 <option key={p._id} value={p._id}>\n//                   {p.name} ({p.city})\n//                 </option>\n//               ))}\n//             </select>\n\n//             <label htmlFor=\"selectPuja\">Select Puja / Service:</label>\n//             <select\n//               id=\"selectPuja\"\n//               value={selectedServiceId}\n//               onChange={handleServiceSelect}\n//               aria-required=\"true\"\n//               required\n//               disabled={!selectedPandit || servicesOptions.length === 0}\n//             >\n//               <option value=\"\">\n//                 {selectedPandit\n//                   ? servicesOptions.length > 0\n//                     ? \"-- Select Puja --\"\n//                     : \"No services available\"\n//                   : \"Select Pandit first\"}\n//               </option>\n//               {servicesOptions.map((svc) => (\n//                 <option key={svc._id || svc.id} value={svc._id || svc.id}>\n//                   {svc.name}\n//                 </option>\n//               ))}\n//             </select>\n\n//             <label htmlFor=\"puja_date\">Select Date:</label>\n//             <input\n//               type=\"date\"\n//               id=\"puja_date\"\n//               name=\"puja_date\"\n//               value={bookingDetails.puja_date}\n//               onChange={handleBookingDetailsChange}\n//               min={new Date().toISOString().split(\"T\")[0]}\n//               aria-required=\"true\"\n//               required\n//             />\n\n//             <label htmlFor=\"puja_time\">Select Time:</label>\n//             <input\n//               type=\"time\"\n//               id=\"puja_time\"\n//               name=\"puja_time\"\n//               value={bookingDetails.puja_time}\n//               onChange={handleBookingDetailsChange}\n//               aria-required=\"true\"\n//               required\n//             />\n\n//             <label htmlFor=\"location\">Location / Address:</label>\n//             <input\n//               type=\"text\"\n//               id=\"location\"\n//               name=\"location\"\n//               value={bookingDetails.location}\n//               onChange={handleBookingDetailsChange}\n//               placeholder=\"Enter location or address\"\n//               aria-required=\"true\"\n//               required\n//               autoComplete=\"street-address\"\n//             />\n\n//             <button\n//               type=\"submit\"\n//               className=\"custom-btn glow-btn\"\n//               disabled={bookingLoading}\n//             >\n//               {bookingLoading ? \"Booking...\" : \"Confirm Booking\"}\n//             </button>\n//             {bookingStatus?.error && (\n//               <p className=\"error-message\" role=\"alert\">{bookingStatus.error}</p>\n//             )}\n//             {bookingStatus?.success && (\n//               <p className=\"success-message\" role=\"alert\">{bookingStatus.success}</p>\n//             )}\n//           </form>\n//         </section>\n\n//         {/* Chat Window */}\n//         <AnimatePresence>\n//           {chatPanditId && (\n//             <ChatWindow\n//               userId={user?._id}\n//               panditId={chatPanditId}\n//               chatName={chatPanditName}\n//               onClose={() => setChatPanditId(null)}\n//             />\n//           )}\n//         </AnimatePresence>\n\n//         {/* Bookings */}\n//         <section\n//           id=\"booking\"\n//           className=\"bookings-section horizontal-carousel-section blur-bg\"\n//           tabIndex={-1}\n//           aria-label=\"Booking History\"\n//         >\n//           <div className=\"section-header\">\n//             <h3 className=\"section-heading highlighted-heading\">Your Bookings</h3>\n//             <div className=\"carousel-controls\">\n//               <button\n//                 aria-label=\"Scroll bookings left\"\n//                 onClick={() => scrollList(bookingListRef, \"left\")}\n//                 className=\"carousel-arrow-btn\"\n//               >\n//                 <ChevronLeft size={24} />\n//               </button>\n//               <button\n//                 aria-label=\"Scroll bookings right\"\n//                 onClick={() => scrollList(bookingListRef, \"right\")}\n//                 className=\"carousel-arrow-btn\"\n//               >\n//                 <ChevronRight size={24} />\n//               </button>\n//             </div>\n//           </div>\n//           <input\n//             type=\"text\"\n//             className=\"booking-search\"\n//             aria-label=\"Search bookings\"\n//             placeholder=\"Search bookings...\"\n//             value={searchBookings}\n//             onChange={(e) => setSearchBookings(e.target.value)}\n//           />\n//           <div\n//             className=\"booking-list horizontal-scroll\"\n//             ref={bookingListRef}\n//             tabIndex={0}\n//           >\n//             {filteredBookings.length === 0 ? (\n//               <p className=\"empty-msg\">\n//                 No bookings found. Book your first puja now!\n//               </p>\n//             ) : (\n//               filteredBookings.map((b) => (\n//                 <motion.div\n//                   key={b._id}\n//                   className=\"booking-card card-glossy glass neon-card shadow-pop horizontal-card\"\n//                   whileHover={{ scale: 1.032, boxShadow: \"0 6px 32px #aecaee51\" }}\n//                   tabIndex={0}\n//                   role=\"article\"\n//                   aria-label={`Booking for ${b.serviceid?.name} with ${\n//                     b.panditid?.name || \"N/A\"\n//                   } on ${new Date(b.puja_date).toLocaleDateString()} at ${\n//                     b.puja_time\n//                   }`}\n//                 >\n//                   <div className=\"booking-card-left\">\n//                     <span className=\"booking-icon\" aria-hidden=\"true\">\n//                       📅\n//                     </span>\n//                     <div>\n//                       <div className=\"booking-type\">{b.serviceid?.name}</div>\n//                       <div className=\"booking-date\">\n//                         {new Date(b.puja_date).toLocaleDateString()} at {b.puja_time}\n//                       </div>\n//                     </div>\n//                   </div>\n//                   <div className=\"booking-card-right\">\n//                     <div className=\"booking-pandit\">\n//                       <span className=\"booking-pandit-label\">Pandit:</span>{\" \"}\n//                       <span>{b.panditid?.name ?? \"N/A\"}</span>\n//                     </div>\n//                     <div className=\"booking-location\">📍 {b.location}</div>\n//                     <div className={getStatusClass(b.status)}>{b.status}</div>\n//                   </div>\n//                 </motion.div>\n//               ))\n//             )}\n//           </div>\n//         </section>\n\n//         {/* Review Submission */}\n//         <section\n//           id=\"review\"\n//           className=\"review-section glass-review\"\n//           tabIndex={-1}\n//           aria-label=\"Submit Review\"\n//         >\n//           <h3 className=\"section-heading neon-text\">Submit a Review</h3>\n//           {reviewMessage && (\n//             <p\n//               className={\n//                 reviewMessage.includes(\"review\")\n//                   ? \"success-message\"\n//                   : \"error-message\"\n//               }\n//             >\n//               {reviewMessage}\n//             </p>\n//           )}\n//           <form\n//             onSubmit={handleReviewSubmit}\n//             className=\"review-form card-glossy glass nice-glass\"\n//             aria-label=\"Review submission form\"\n//           >\n//             <div className=\"review-row\">\n//               <input\n//                 type=\"text\"\n//                 value={review.name}\n//                 disabled\n//                 className=\"review-input\"\n//                 aria-label=\"Your name\"\n//               />\n//               <StarRating\n//                 rating={review.rating}\n//                 onChange={(v) => setReview((prev) => ({ ...prev, rating: v }))}\n//               />\n//             </div>\n//             <textarea\n//               placeholder=\"Write your feedback...\"\n//               value={review.comment}\n//               onChange={(e) =>\n//                 setReview((prev) => ({ ...prev, comment: e.target.value }))\n//               }\n//               className=\"review-input review-textarea\"\n//               required\n//               aria-required=\"true\"\n//             />\n//             <button\n//               type=\"submit\"\n//               className=\"custom-btn glow-btn\"\n//               disabled={reviewLoading}\n//             >\n//               {reviewLoading ? \"Submitting...\" : \"Submit Review 💬\"}\n//             </button>\n//           </form>\n//         </section>\n\n//         {/* Chatbot Button */}\n//         <button\n//           aria-label=\"Toggle Chatbot\"\n//           className=\"chatbot-toggle\"\n//           onClick={() => setShowChatbot((s) => !s)}\n//         >\n//           {showChatbot ? (\n//             \"×\"\n//           ) : (\n//             <img\n//               src=\"/images/subh.png\"\n//               alt=\"Open Chatbot\"\n//               style={{ borderRadius: \"50%\", width: 38, height: 38 }}\n//             />\n//           )}\n//         </button>\n//         {showChatbot && (\n//           <div\n//             className=\"chatbot-popup\"\n//             role=\"dialog\"\n//             aria-modal=\"true\"\n//             aria-label=\"Chatbot window\"\n//           >\n//             <iframe\n//               title=\"Chatbot\"\n//               src=\"https://www.chatbase.co/chatbot-iframe/usovl2iS71gPfrO5xmRyP\"\n//               style={{ width: \"100%\", height: \"100%\", border: \"none\", borderRadius: 15 }}\n//               allow=\"clipboard-write\"\n//             />\n//           </div>\n//         )}\n//       </main>\n//     </div>\n//   );\n// }","map":{"version":3,"names":[],"sources":["C:/Users/sv106/OneDrive/Desktop/Shubhkarya/Frontend/pandit-booking-frontend/src/pages/Dashboard.js"],"sourcesContent":["// import React, { useState, useEffect, useRef } from \"react\";\r\n// import {\r\n//   Home,\r\n//   CalendarDays,\r\n//   Book,\r\n//   LogOut,\r\n//   ListChecks,\r\n//   MessageCircle,\r\n//   Search,\r\n//   Users,\r\n//   ChevronLeft,\r\n//   ChevronRight,\r\n// } from \"lucide-react\";\r\n// import { AnimatePresence, motion } from \"framer-motion\";\r\n// import AOS from \"aos\";\r\n// import \"aos/dist/aos.css\";\r\n// import \"./Dashboard.css\";\r\n// import {\r\n//   createReview,\r\n//   getBookings,\r\n//   getVerifiedPandits,\r\n//   bookPuja,\r\n// } from \"../api/api\"; // <-- add your actual booking API here\r\n// import ChatWindow from \"./ChatWindow\";\r\n// import { useNavigate } from \"react-router-dom\";\r\n\r\n// const sidebarLinks = [\r\n//   { label: \"Home\", icon: Home, goto: \"/\" },\r\n//   { label: \"Book Puja\", icon: Book, goto: \"/booking\" },\r\n//   { label: \"Submit Review\", icon: MessageCircle, goto: \"#review\" },\r\n//   { label: \"Pandits\", icon: Users, goto: \"#pandit\" },\r\n//   { label: \"Search\", icon: Search, goto: \"#highlight\" },\r\n//   { label: \"Bookings\", icon: CalendarDays, goto: \"#booking\" },\r\n//   { label: \"Logout\", icon: LogOut, goto: \"/home\", logout: true },\r\n// ];\r\n\r\n// const sliderImages = [\r\n//   \"/images/i2.jpeg\",\r\n//   \"/images/kalash.jpeg\",\r\n//   \"/images/havan.jpeg\",\r\n//   \"/images/i3.jpeg\",\r\n//   \"/images/i1.jpeg\",\r\n// ];\r\n\r\n// function StarRating({ rating, onChange }) {\r\n//   return (\r\n//     <div className=\"star-rating\" aria-label=\"Rating\">\r\n//       {[1, 2, 3, 4, 5].map((i) => (\r\n//         <span\r\n//           key={i}\r\n//           role=\"button\"\r\n//           tabIndex=\"0\"\r\n//           className={`star ${i <= rating ? \"active\" : \"\"}`}\r\n//           aria-label={`Rate ${i} star${i > 1 ? \"s\" : \"\"}`}\r\n//           onClick={() => onChange(i)}\r\n//           onKeyDown={(e) =>\r\n//             (e.key === \"Enter\" || e.key === \" \") && onChange(i)\r\n//           }\r\n//         >\r\n//           ★\r\n//         </span>\r\n//       ))}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default function Dashboard() {\r\n//   const [user, setUser] = useState(null);\r\n//   const [bookings, setBookings] = useState([]);\r\n//   const [pandits, setPandits] = useState([]);\r\n//   const [collapsed, setCollapsed] = useState(false);\r\n//   const [carouselIndex, setCarouselIndex] = useState(0);\r\n//   const [expandedPandits, setExpandedPandits] = useState({});\r\n//   const [searchPandits, setSearchPandits] = useState(\"\");\r\n//   const [searchBookings, setSearchBookings] = useState(\"\");\r\n//   const [review, setReview] = useState({ name: \"\", rating: 0, comment: \"\" });\r\n//   const [reviewMessage, setReviewMessage] = useState(\"\");\r\n//   const [reviewLoading, setReviewLoading] = useState(false);\r\n//   const [showChatbot, setShowChatbot] = useState(false);\r\n//   const [chatPanditId, setChatPanditId] = useState(null);\r\n//   const [chatPanditName, setChatPanditName] = useState(\"\");\r\n//   const [currentDateTime, setCurrentDateTime] = useState(\"\");\r\n\r\n//   // Booking state integrated in dashboard\r\n//   const [selectedPanditId, setSelectedPanditId] = useState(\"\");\r\n//   const [selectedServiceId, setSelectedServiceId] = useState(\"\");\r\n//   const [bookingDetails, setBookingDetails] = useState({\r\n//     puja_date: \"\",\r\n//     puja_time: \"\",\r\n//     location: \"\",\r\n//   });\r\n//   const [bookingStatus, setBookingStatus] = useState(null);\r\n//   const [bookingLoading, setBookingLoading] = useState(false);\r\n\r\n//   const navigate = useNavigate();\r\n\r\n//   const panditListRef = useRef(null);\r\n//   const bookingListRef = useRef(null);\r\n\r\n//   // Fetch user, bookings, pandits on mount\r\n//   useEffect(() => {\r\n//     AOS.init({ duration: 750, once: true });\r\n//     const token = localStorage.getItem(\"token\");\r\n//     const userData = localStorage.getItem(\"user\");\r\n//     if (!token || !userData) return;\r\n//     try {\r\n//       const parsedUser = JSON.parse(userData);\r\n//       setUser(parsedUser);\r\n//       setReview((r) => ({ ...r, name: parsedUser.name }));\r\n//       getBookings({ userid: parsedUser._id }).then((res) =>\r\n//         setBookings(res.data || [])\r\n//       );\r\n//       getVerifiedPandits().then((res) => setPandits(res.data || []));\r\n//     } catch {}\r\n//   }, []);\r\n\r\n//   useEffect(() => {\r\n//     const interval = setInterval(() => {\r\n//       setCarouselIndex((i) => (i + 1) % sliderImages.length);\r\n//     }, 4500);\r\n//     return () => clearInterval(interval);\r\n//   }, []);\r\n\r\n//   useEffect(() => {\r\n//     const itv = setInterval(() => {\r\n//       setCurrentDateTime(\r\n//         new Date().toLocaleString(\"en-IN\", {\r\n//           dateStyle: \"full\",\r\n//           timeStyle: \"medium\",\r\n//           timeZone: \"Asia/Kolkata\",\r\n//         })\r\n//       );\r\n//     }, 1000);\r\n//     return () => clearInterval(itv);\r\n//   }, []);\r\n\r\n//   function toggleExpand(id) {\r\n//     setExpandedPandits((prev) => ({ ...prev, [id]: !prev[id] }));\r\n//   }\r\n\r\n//   const getStatusClass = (status) =>\r\n//     ({\r\n//       accepted: \"status accepted\",\r\n//       rejected: \"status rejected\",\r\n//       pending: \"status pending\",\r\n//     }[(status || \"\").toLowerCase()] || \"status\");\r\n\r\n//   const filteredPandits = pandits.filter(\r\n//     (p) =>\r\n//       (p.name?.toLowerCase() || \"\").includes(searchPandits.toLowerCase()) ||\r\n//       (p.city || \"\").toLowerCase().includes(searchPandits.toLowerCase())\r\n//   );\r\n\r\n//   const filteredBookings = bookings.filter((b) => {\r\n//     const q = searchBookings.toLowerCase();\r\n//     return (\r\n//       (b.panditid?.name || \"\").toLowerCase().includes(q) ||\r\n//       (b.serviceid?.name || \"\").toLowerCase().includes(q) ||\r\n//       new Date(b.puja_date).toLocaleDateString().includes(q)\r\n//     );\r\n//   });\r\n\r\n//   async function handleReviewSubmit(e) {\r\n//     e.preventDefault();\r\n//     if (!review.name || !review.comment || !review.rating) {\r\n//       setReviewMessage(\"Please complete all fields and provide star rating.\");\r\n//       return;\r\n//     }\r\n//     setReviewLoading(true);\r\n//     try {\r\n//       await createReview(review);\r\n//       setReviewMessage(\"Thank you for your review!\");\r\n//       setReview((r) => ({ name: r.name, rating: 0, comment: \"\" }));\r\n//     } catch {\r\n//       setReviewMessage(\"Failed to submit review.\");\r\n//     } finally {\r\n//       setReviewLoading(false);\r\n//       setTimeout(() => setReviewMessage(\"\"), 2500);\r\n//     }\r\n//   }\r\n\r\n//   function handleNavClick(item) {\r\n//     if (item.logout) {\r\n//       localStorage.clear();\r\n//       alert(\"Logout clicked, implement navigation\");\r\n//     } else if (String(item.goto).startsWith(\"#\")) {\r\n//       const section = document.querySelector(item.goto);\r\n//       if (section)\r\n//         section.scrollIntoView({\r\n//           behavior: \"smooth\",\r\n//           block: \"start\",\r\n//           inline: \"nearest\",\r\n//         });\r\n//     } else {\r\n//       navigate(item.goto);\r\n//     }\r\n//   }\r\n\r\n//   function scrollList(ref, direction = \"left\") {\r\n//     if (ref.current) {\r\n//       const scrollAmount = 320;\r\n//       if (direction === \"left\") {\r\n//         ref.current.scrollBy({ left: -scrollAmount, behavior: \"smooth\" });\r\n//       } else {\r\n//         ref.current.scrollBy({ left: scrollAmount, behavior: \"smooth\" });\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   // Booking form handlers\r\n//   function handlePanditSelect(e) {\r\n//     const panditId = e.target.value;\r\n//     setSelectedPanditId(panditId);\r\n//     setSelectedServiceId(\"\"); // reset selected service on pandit change\r\n//     setBookingStatus(null);\r\n//   }\r\n\r\n//   function handleServiceSelect(e) {\r\n//     setSelectedServiceId(e.target.value);\r\n//     setBookingStatus(null);\r\n//   }\r\n\r\n//   function handleBookingDetailsChange(e) {\r\n//     const { name, value } = e.target;\r\n//     setBookingDetails((b) => ({ ...b, [name]: value }));\r\n//     setBookingStatus(null);\r\n//   }\r\n\r\n//   async function handleBookingSubmit(e) {\r\n//     e.preventDefault();\r\n//     setBookingStatus(null);\r\n\r\n//     if (!selectedPanditId) {\r\n//       setBookingStatus({ error: \"Please select a Pandit.\" });\r\n//       return;\r\n//     }\r\n//     if (!selectedServiceId) {\r\n//       setBookingStatus({ error: \"Please select the Puja/service.\" });\r\n//       return;\r\n//     }\r\n//     if (\r\n//       !bookingDetails.puja_date ||\r\n//       !bookingDetails.puja_time ||\r\n//       !bookingDetails.location.trim()\r\n//     ) {\r\n//       setBookingStatus({ error: \"Please fill all booking details.\" });\r\n//       return;\r\n//     }\r\n//     if(!user?._id) {\r\n//       setBookingStatus({ error: \"User not found. Please login again.\" });\r\n//       return;\r\n//     }\r\n\r\n//     setBookingLoading(true);\r\n\r\n//     try {\r\n//       // Prepare payload\r\n//       const payload = {\r\n//         userId: user._id,\r\n//         panditId: selectedPanditId,\r\n//         serviceId: selectedServiceId,\r\n//         puja_date: bookingDetails.puja_date,\r\n//         puja_time: bookingDetails.puja_time,\r\n//         location: bookingDetails.location.trim(),\r\n//         status: \"pending\",\r\n//       };\r\n\r\n//       // Replace this with your actual booking API call\r\n//       if (typeof bookPuja === \"function\") {\r\n//         await bookPuja(payload);\r\n//       } else {\r\n//         // Mock API delay\r\n//         await new Promise((res) => setTimeout(res, 1000));\r\n//       }\r\n\r\n//       setBookingStatus({ success: \"Puja booked successfully!\" });\r\n\r\n//       // Refresh bookings list after booking\r\n//       const res = await getBookings({ userid: user._id });\r\n//       setBookings(res.data || []);\r\n\r\n//       // Reset booking form\r\n//       setSelectedPanditId(\"\");\r\n//       setSelectedServiceId(\"\");\r\n//       setBookingDetails({ puja_date: \"\", puja_time: \"\", location: \"\" });\r\n//     } catch (error) {\r\n//       setBookingStatus({\r\n//         error:\r\n//           error?.message ||\r\n//           \"Failed to book puja. Please try again later.\",\r\n//       });\r\n//     } finally {\r\n//       setBookingLoading(false);\r\n//     }\r\n//   }\r\n\r\n//   // Get selected pandit's services (pujas)\r\n//   const selectedPandit =\r\n//     pandits.find((p) => p._id === selectedPanditId) || null;\r\n\r\n//   const servicesOptions = selectedPandit?.services || []; // Assuming your pandit object has a services array\r\n\r\n//   return (\r\n//     <div className=\"dashboard-app-bg\">\r\n//       {/* Sidebar */}\r\n//       <aside className={`sidebar-root${collapsed ? \" collapsed\" : \"\"}`}>\r\n//         <div className=\"sidebar-brand\">\r\n//           <img src=\"/images/subh.png\" alt=\"Logo\" className=\"sidebar-logo\" />\r\n//           {!collapsed && (\r\n//             <span\r\n//               className=\"sidebar-brand-name white-logo\"\r\n//               tabIndex={0}\r\n//               style={{ color: \"#1abc9c\" }}\r\n//             >\r\n//               Shubhkarya\r\n//             </span>\r\n//           )}\r\n//         </div>\r\n//         <nav className=\"sidebar-links\" aria-label=\"Main navigation\">\r\n//           {sidebarLinks.map(({ label, icon: Icon, goto, logout }) => (\r\n//             <button\r\n//               key={label}\r\n//               className=\"sidebar-link\"\r\n//               tabIndex={0}\r\n//               onClick={() => handleNavClick({ goto, logout })}\r\n//               aria-label={label}\r\n//             >\r\n//               <Icon\r\n//                 size={22}\r\n//                 className=\"sidebar-link-icon\"\r\n//                 aria-hidden=\"true\"\r\n//                 style={{ color: \"#1abc9c\" }}\r\n//               />\r\n//               {!collapsed && (\r\n//                 <span style={{ color: \"#1abc9c\", fontWeight: \"700\" }}>\r\n//                   {label}\r\n//                 </span>\r\n//               )}\r\n//             </button>\r\n//           ))}\r\n//         </nav>\r\n//         <button\r\n//           className=\"sidebar-collapse-btn\"\r\n//           onClick={() => setCollapsed((c) => !c)}\r\n//           aria-label={collapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\r\n//           style={{ color: \"#1abc9c\" }}\r\n//         >\r\n//           <ListChecks size={22} />\r\n//         </button>\r\n//       </aside>\r\n\r\n//       {/* Header */}\r\n//       <header className=\"header-root dark-header\">\r\n//         <div className=\"user-block\">\r\n//           <div>\r\n//             <div className=\"header-user-welcome dark-welcome\">\r\n//               {user?.name ? `Welcome, ${user.name}!` : \"Welcome to Shubhkarya\"}\r\n//             </div>\r\n//             <div className=\"header-user-email dark-email\">\r\n//               {user?.email || \"user@example.com\"}\r\n//             </div>\r\n//           </div>\r\n//         </div>\r\n//         <div className=\"header-datetime dark-datetime\">{currentDateTime}</div>\r\n//       </header>\r\n\r\n//       <main className=\"dashboard-main\">\r\n//         {/* Hero & Slider */}\r\n//         <section className=\"hero-section\">\r\n//           <div className=\"hero-content\">\r\n//             <h1 className=\"hero-title\">\r\n//               Experience{\" \"}\r\n//               <span className=\"hero-highlight\">Auspicious Rituals</span> with{\" \"}\r\n//               <span className=\"hero-brand-white\">Shubhkarya</span>\r\n//             </h1>\r\n//             <p className=\"hero-subtitle\">\r\n//               Welcome{user?.name && <span>, <b>{user.name}</b></span>}!\r\n//               <br />\r\n//               Book trusted Pandits for your{\" \"}\r\n//               <span style={{ color: \"#fcd75a\", fontWeight: 600 }}>\r\n//                 pujas, havans, and ceremonies\r\n//               </span>{\" \"}\r\n//               with elegance and ease.\r\n//               <br />\r\n//               Now enhanced with same-day bookings and instant chat support.\r\n//             </p>\r\n//             <div className=\"hero-actions\">\r\n//               <button\r\n//                 className=\"main-cta-btn\"\r\n//                 onClick={() => navigate(\"/booking\")}\r\n//               >\r\n//                 Book Puja Now\r\n//               </button>\r\n//               <button\r\n//                 className=\"main-alt-btn\"\r\n//                 onClick={() => {\r\n//                   const panditSection = document.querySelector(\"#pandit\");\r\n//                   if (panditSection) {\r\n//                     panditSection.scrollIntoView({ behavior: \"smooth\" });\r\n//                   }\r\n//                 }}\r\n//               >\r\n//                 Browse Pandits\r\n//               </button>\r\n//             </div>\r\n//           </div>\r\n//           <div className=\"slider-wrapper\">\r\n//             <div className=\"carousel-frame hero-slider-bg\">\r\n//               <img\r\n//                 src={sliderImages[carouselIndex]}\r\n//                 alt={`Slide ${carouselIndex + 1}`}\r\n//                 loading=\"lazy\"\r\n//               />\r\n//               <div className=\"carousel-dots\">\r\n//                 {sliderImages.map((_, i) => (\r\n//                   <button\r\n//                     key={i}\r\n//                     className={`carousel-dot${carouselIndex === i ? \" active\" : \"\"}`}\r\n//                     onClick={() => setCarouselIndex(i)}\r\n//                     aria-selected={carouselIndex === i}\r\n//                     role=\"tab\"\r\n//                     aria-label={`Go to slide ${i + 1}`}\r\n//                   />\r\n//                 ))}\r\n//               </div>\r\n//               <div className=\"slider-caption\">\r\n//                 <div>\r\n//                   Find <span style={{ color: \"#fcd75a\" }}>expert guidance</span>{\" \"}\r\n//                   for every ritual\r\n//                 </div>\r\n//               </div>\r\n//             </div>\r\n//           </div>\r\n//         </section>\r\n\r\n//         {/* Feature Cards */}\r\n//         <section className=\"dashboard-features\">\r\n//           <div className=\"feature-card\">\r\n//             <h3>Live Chat Support</h3>\r\n//             <p>Ask spiritual or booking questions to our team – instant help, 7am to 10pm.</p>\r\n//           </div>\r\n//           <div className=\"feature-card\">\r\n//             <h3>Preferred Pandit Booking</h3>\r\n//             <p>Save favorite Pandits, see their next available slots, and book with just one tap.</p>\r\n//           </div>\r\n//           <div className=\"feature-card\">\r\n//             <h3>Festive Offers</h3>\r\n//             <p>Special discounts and promo codes for all major festivals and family events.</p>\r\n//           </div>\r\n//         </section>\r\n\r\n//         {/* Verified Pandits */}\r\n//         <section\r\n//           id=\"pandit\"\r\n//           className=\"pandit-section horizontal-carousel-section\"\r\n//           tabIndex={-1}\r\n//           aria-label=\"Verified Pandits\"\r\n//         >\r\n//           <div className=\"section-header\">\r\n//             <h3 className=\"section-heading highlighted-heading\">Verified Pandits</h3>\r\n//             <div className=\"carousel-controls\">\r\n//               <button\r\n//                 aria-label=\"Scroll pandits left\"\r\n//                 onClick={() => scrollList(panditListRef, \"left\")}\r\n//                 className=\"carousel-arrow-btn\"\r\n//               >\r\n//                 <ChevronLeft size={24} />\r\n//               </button>\r\n//               <button\r\n//                 aria-label=\"Scroll pandits right\"\r\n//                 onClick={() => scrollList(panditListRef, \"right\")}\r\n//                 className=\"carousel-arrow-btn\"\r\n//               >\r\n//                 <ChevronRight size={24} />\r\n//               </button>\r\n//             </div>\r\n//           </div>\r\n//           <input\r\n//             type=\"text\"\r\n//             className=\"booking-search\"\r\n//             aria-label=\"Search pandits\"\r\n//             placeholder=\"Search by name or city...\"\r\n//             value={searchPandits}\r\n//             onChange={(e) => setSearchPandits(e.target.value)}\r\n//           />\r\n//           <div\r\n//             className=\"pandit-list horizontal-scroll\"\r\n//             ref={panditListRef}\r\n//             tabIndex={0}\r\n//           >\r\n//             {filteredPandits.map((pandit) => (\r\n//               <motion.div\r\n//                 key={pandit._id}\r\n//                 className=\"improved-pandit-card neon-card glass-highlight glossy shadow-pop horizontal-card\"\r\n//                 whileHover={{ y: -4, scale: 1.04 }}\r\n//                 tabIndex={0}\r\n//                 aria-expanded={expandedPandits[pandit._id] || false}\r\n//                 onClick={() => toggleExpand(pandit._id)}\r\n//                 onKeyDown={(e) =>\r\n//                   (e.key === \"Enter\" || e.key === \" \") && toggleExpand(pandit._id)\r\n//                 }\r\n//               >\r\n//                 <div\r\n//                   className=\"pandit-avatar glass\"\r\n//                   style={{\r\n//                     backgroundImage: `url(${pandit.profile_photo_url || \"/images/i1.jpeg\"})`,\r\n//                   }}\r\n//                   aria-label={`Pandit ${pandit.name}`}\r\n//                 >\r\n//                   <span className=\"pandit-avatar-initial\">{pandit.name.slice(0, 1)}</span>\r\n//                 </div>\r\n//                 <div className=\"pandit-main-info\">\r\n//                   <h4 className=\"pandit-name hero-text-glow\">🧑‍🦳 {pandit.name}</h4>\r\n//                   <div className=\"pandit-city\">{pandit.city}</div>\r\n//                   {expandedPandits[pandit._id] && (\r\n//                     <div className=\"pandit-extra expanded horizontal-extra\">\r\n//                       <div className=\"pandit-details\">\r\n//                         <div className=\"pandit-badges\">\r\n//                           <span className=\"pandit-badge exp\">\r\n//                             Exp: {pandit.experienceYears} yrs\r\n//                           </span>\r\n//                           <span className=\"pandit-badge langs\">\r\n//                             {pandit.languages?.join(\", \")}\r\n//                           </span>\r\n//                         </div>\r\n//                         <div className=\"pandit-specialties\">\r\n//                           <b>Specialties:</b> {pandit.specialties?.join(\", \")}\r\n//                         </div>\r\n//                       </div>\r\n//                     </div>\r\n//                   )}\r\n//                   <button\r\n//                     onClick={(e) => {\r\n//                       e.stopPropagation();\r\n//                       setChatPanditId(pandit._id);\r\n//                       setChatPanditName(pandit.name);\r\n//                     }}\r\n//                     style={{ marginTop: 8 }}\r\n//                     aria-label={`Chat with ${pandit.name}`}\r\n//                   >\r\n//                     Chat with Pandit\r\n//                   </button>\r\n//                 </div>\r\n//               </motion.div>\r\n//             ))}\r\n//           </div>\r\n//         </section>\r\n\r\n//         {/* NEW Booking Section - Integrated on same page */}\r\n//         <section\r\n//           id=\"book-puja\"\r\n//           className=\"book-puja-section glass-review\"\r\n//           aria-label=\"Book Puja\"\r\n//           tabIndex={-1}\r\n//           style={{ marginTop: \"3rem\", marginBottom: \"3rem\", maxWidth: 700, marginLeft:\"auto\", marginRight:\"auto\" }}\r\n//         >\r\n//           <h3 className=\"section-heading highlighted-heading\" style={{ textAlign: \"center\" }}>\r\n//             Book Your Puja\r\n//           </h3>\r\n\r\n//           <form onSubmit={handleBookingSubmit} className=\"booking-form-dashboard\" aria-live=\"polite\" noValidate>\r\n//             <label htmlFor=\"selectPandit\">Select Pandit:</label>\r\n//             <select\r\n//               id=\"selectPandit\"\r\n//               value={selectedPanditId}\r\n//               onChange={handlePanditSelect}\r\n//               aria-required=\"true\"\r\n//               required\r\n//             >\r\n//               <option value=\"\">-- Select Pandit --</option>\r\n//               {filteredPandits.map((p) => (\r\n//                 <option key={p._id} value={p._id}>\r\n//                   {p.name} ({p.city})\r\n//                 </option>\r\n//               ))}\r\n//             </select>\r\n\r\n//             <label htmlFor=\"selectPuja\">Select Puja / Service:</label>\r\n//             <select\r\n//               id=\"selectPuja\"\r\n//               value={selectedServiceId}\r\n//               onChange={handleServiceSelect}\r\n//               aria-required=\"true\"\r\n//               required\r\n//               disabled={!selectedPandit || servicesOptions.length === 0}\r\n//             >\r\n//               <option value=\"\">\r\n//                 {selectedPandit\r\n//                   ? servicesOptions.length > 0\r\n//                     ? \"-- Select Puja --\"\r\n//                     : \"No services available\"\r\n//                   : \"Select Pandit first\"}\r\n//               </option>\r\n//               {servicesOptions.map((svc) => (\r\n//                 <option key={svc._id || svc.id} value={svc._id || svc.id}>\r\n//                   {svc.name}\r\n//                 </option>\r\n//               ))}\r\n//             </select>\r\n\r\n//             <label htmlFor=\"puja_date\">Select Date:</label>\r\n//             <input\r\n//               type=\"date\"\r\n//               id=\"puja_date\"\r\n//               name=\"puja_date\"\r\n//               value={bookingDetails.puja_date}\r\n//               onChange={handleBookingDetailsChange}\r\n//               min={new Date().toISOString().split(\"T\")[0]}\r\n//               aria-required=\"true\"\r\n//               required\r\n//             />\r\n\r\n//             <label htmlFor=\"puja_time\">Select Time:</label>\r\n//             <input\r\n//               type=\"time\"\r\n//               id=\"puja_time\"\r\n//               name=\"puja_time\"\r\n//               value={bookingDetails.puja_time}\r\n//               onChange={handleBookingDetailsChange}\r\n//               aria-required=\"true\"\r\n//               required\r\n//             />\r\n\r\n//             <label htmlFor=\"location\">Location / Address:</label>\r\n//             <input\r\n//               type=\"text\"\r\n//               id=\"location\"\r\n//               name=\"location\"\r\n//               value={bookingDetails.location}\r\n//               onChange={handleBookingDetailsChange}\r\n//               placeholder=\"Enter location or address\"\r\n//               aria-required=\"true\"\r\n//               required\r\n//               autoComplete=\"street-address\"\r\n//             />\r\n\r\n//             <button\r\n//               type=\"submit\"\r\n//               className=\"custom-btn glow-btn\"\r\n//               disabled={bookingLoading}\r\n//             >\r\n//               {bookingLoading ? \"Booking...\" : \"Confirm Booking\"}\r\n//             </button>\r\n//             {bookingStatus?.error && (\r\n//               <p className=\"error-message\" role=\"alert\">{bookingStatus.error}</p>\r\n//             )}\r\n//             {bookingStatus?.success && (\r\n//               <p className=\"success-message\" role=\"alert\">{bookingStatus.success}</p>\r\n//             )}\r\n//           </form>\r\n//         </section>\r\n\r\n//         {/* Chat Window */}\r\n//         <AnimatePresence>\r\n//           {chatPanditId && (\r\n//             <ChatWindow\r\n//               userId={user?._id}\r\n//               panditId={chatPanditId}\r\n//               chatName={chatPanditName}\r\n//               onClose={() => setChatPanditId(null)}\r\n//             />\r\n//           )}\r\n//         </AnimatePresence>\r\n\r\n//         {/* Bookings */}\r\n//         <section\r\n//           id=\"booking\"\r\n//           className=\"bookings-section horizontal-carousel-section blur-bg\"\r\n//           tabIndex={-1}\r\n//           aria-label=\"Booking History\"\r\n//         >\r\n//           <div className=\"section-header\">\r\n//             <h3 className=\"section-heading highlighted-heading\">Your Bookings</h3>\r\n//             <div className=\"carousel-controls\">\r\n//               <button\r\n//                 aria-label=\"Scroll bookings left\"\r\n//                 onClick={() => scrollList(bookingListRef, \"left\")}\r\n//                 className=\"carousel-arrow-btn\"\r\n//               >\r\n//                 <ChevronLeft size={24} />\r\n//               </button>\r\n//               <button\r\n//                 aria-label=\"Scroll bookings right\"\r\n//                 onClick={() => scrollList(bookingListRef, \"right\")}\r\n//                 className=\"carousel-arrow-btn\"\r\n//               >\r\n//                 <ChevronRight size={24} />\r\n//               </button>\r\n//             </div>\r\n//           </div>\r\n//           <input\r\n//             type=\"text\"\r\n//             className=\"booking-search\"\r\n//             aria-label=\"Search bookings\"\r\n//             placeholder=\"Search bookings...\"\r\n//             value={searchBookings}\r\n//             onChange={(e) => setSearchBookings(e.target.value)}\r\n//           />\r\n//           <div\r\n//             className=\"booking-list horizontal-scroll\"\r\n//             ref={bookingListRef}\r\n//             tabIndex={0}\r\n//           >\r\n//             {filteredBookings.length === 0 ? (\r\n//               <p className=\"empty-msg\">\r\n//                 No bookings found. Book your first puja now!\r\n//               </p>\r\n//             ) : (\r\n//               filteredBookings.map((b) => (\r\n//                 <motion.div\r\n//                   key={b._id}\r\n//                   className=\"booking-card card-glossy glass neon-card shadow-pop horizontal-card\"\r\n//                   whileHover={{ scale: 1.032, boxShadow: \"0 6px 32px #aecaee51\" }}\r\n//                   tabIndex={0}\r\n//                   role=\"article\"\r\n//                   aria-label={`Booking for ${b.serviceid?.name} with ${\r\n//                     b.panditid?.name || \"N/A\"\r\n//                   } on ${new Date(b.puja_date).toLocaleDateString()} at ${\r\n//                     b.puja_time\r\n//                   }`}\r\n//                 >\r\n//                   <div className=\"booking-card-left\">\r\n//                     <span className=\"booking-icon\" aria-hidden=\"true\">\r\n//                       📅\r\n//                     </span>\r\n//                     <div>\r\n//                       <div className=\"booking-type\">{b.serviceid?.name}</div>\r\n//                       <div className=\"booking-date\">\r\n//                         {new Date(b.puja_date).toLocaleDateString()} at {b.puja_time}\r\n//                       </div>\r\n//                     </div>\r\n//                   </div>\r\n//                   <div className=\"booking-card-right\">\r\n//                     <div className=\"booking-pandit\">\r\n//                       <span className=\"booking-pandit-label\">Pandit:</span>{\" \"}\r\n//                       <span>{b.panditid?.name ?? \"N/A\"}</span>\r\n//                     </div>\r\n//                     <div className=\"booking-location\">📍 {b.location}</div>\r\n//                     <div className={getStatusClass(b.status)}>{b.status}</div>\r\n//                   </div>\r\n//                 </motion.div>\r\n//               ))\r\n//             )}\r\n//           </div>\r\n//         </section>\r\n\r\n//         {/* Review Submission */}\r\n//         <section\r\n//           id=\"review\"\r\n//           className=\"review-section glass-review\"\r\n//           tabIndex={-1}\r\n//           aria-label=\"Submit Review\"\r\n//         >\r\n//           <h3 className=\"section-heading neon-text\">Submit a Review</h3>\r\n//           {reviewMessage && (\r\n//             <p\r\n//               className={\r\n//                 reviewMessage.includes(\"review\")\r\n//                   ? \"success-message\"\r\n//                   : \"error-message\"\r\n//               }\r\n//             >\r\n//               {reviewMessage}\r\n//             </p>\r\n//           )}\r\n//           <form\r\n//             onSubmit={handleReviewSubmit}\r\n//             className=\"review-form card-glossy glass nice-glass\"\r\n//             aria-label=\"Review submission form\"\r\n//           >\r\n//             <div className=\"review-row\">\r\n//               <input\r\n//                 type=\"text\"\r\n//                 value={review.name}\r\n//                 disabled\r\n//                 className=\"review-input\"\r\n//                 aria-label=\"Your name\"\r\n//               />\r\n//               <StarRating\r\n//                 rating={review.rating}\r\n//                 onChange={(v) => setReview((prev) => ({ ...prev, rating: v }))}\r\n//               />\r\n//             </div>\r\n//             <textarea\r\n//               placeholder=\"Write your feedback...\"\r\n//               value={review.comment}\r\n//               onChange={(e) =>\r\n//                 setReview((prev) => ({ ...prev, comment: e.target.value }))\r\n//               }\r\n//               className=\"review-input review-textarea\"\r\n//               required\r\n//               aria-required=\"true\"\r\n//             />\r\n//             <button\r\n//               type=\"submit\"\r\n//               className=\"custom-btn glow-btn\"\r\n//               disabled={reviewLoading}\r\n//             >\r\n//               {reviewLoading ? \"Submitting...\" : \"Submit Review 💬\"}\r\n//             </button>\r\n//           </form>\r\n//         </section>\r\n\r\n//         {/* Chatbot Button */}\r\n//         <button\r\n//           aria-label=\"Toggle Chatbot\"\r\n//           className=\"chatbot-toggle\"\r\n//           onClick={() => setShowChatbot((s) => !s)}\r\n//         >\r\n//           {showChatbot ? (\r\n//             \"×\"\r\n//           ) : (\r\n//             <img\r\n//               src=\"/images/subh.png\"\r\n//               alt=\"Open Chatbot\"\r\n//               style={{ borderRadius: \"50%\", width: 38, height: 38 }}\r\n//             />\r\n//           )}\r\n//         </button>\r\n//         {showChatbot && (\r\n//           <div\r\n//             className=\"chatbot-popup\"\r\n//             role=\"dialog\"\r\n//             aria-modal=\"true\"\r\n//             aria-label=\"Chatbot window\"\r\n//           >\r\n//             <iframe\r\n//               title=\"Chatbot\"\r\n//               src=\"https://www.chatbase.co/chatbot-iframe/usovl2iS71gPfrO5xmRyP\"\r\n//               style={{ width: \"100%\", height: \"100%\", border: \"none\", borderRadius: 15 }}\r\n//               allow=\"clipboard-write\"\r\n//             />\r\n//           </div>\r\n//         )}\r\n//       </main>\r\n//     </div>\r\n//   );\r\n// }\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}